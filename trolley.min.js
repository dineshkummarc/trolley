trolley=function(){function b(a,b){var c;for(c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function c(a,b){var c;for(c in b)b.hasOwnProperty(c)&&typeof a[c]=="undefined"&&(a[c]=b[c]);return a}function d(a,b){var c,d=0;a=[].concat(a);for(c=0;c<a.length;c++)typeof a[c]!="undefined"&&(b(a[c],d),d++)}function e(a,b,c){return a+b/2-c/2}function f(b){return a=b,a||(a=new b2World(new b2Vec2(0,-9.81),!0),a.SetWarmStarting(!0)),a}function g(c,f,g){function i(a){a.x=Math.abs(a.x),a.y=Math.abs(a.y),a.x+a.width>h.width&&(h.width=a.x+a.width),a.y+a.height>h.height&&(h.height=a.y+a.height)}var h={boxes:[],circles:[],width:0,height:0,bodyDef:new b2BodyDef};return arguments.length===1&&(g=c.isStatic,f=c.y,c=c.x),typeof g=="boolean"&&g?h.bodyDef.type=b2Body.b2_staticBody:h.bodyDef.type=b2Body.b2_dynamicBody,typeof g=="object"&&b(h.bodyDef,g),h.box=function(a,b,c,d,e){var f;if(arguments.length<1)throw"box must have arguments, at least object or width, height";return arguments.length===1&&(f=a),arguments.length<4&&(e=c,c=a,d=b,a=b=0),f||(f={x:a,y:b,width:c,height:d,options:e}),h.boxes.push(f),i(f),h},h.circle=function(a,b,c,d){var e;if(arguments.length<1)throw"circle must have arguments, at least object or size";return arguments.length===1&&typeof a!="number"&&(e=a),arguments.length<3&&(d=b,c=a,a=b=0),e||(e={x:a,y:b,size:c,options:d}),h.circles.push(e),i(e),h},h.create=function(){function k(a,c){fixtureDef=new b2FixtureDef,b(fixtureDef,{density:1}),b(fixtureDef,c),fixtureDef.shape=a,g.CreateFixture(fixtureDef)}var g,i=h.width/2,j=h.height/2;return h.bodyDef.position.Set(c+i,f+j),g=a.CreateBody(h.bodyDef),d(h.boxes,function(a){var b=new b2PolygonShape.AsBox(a.width/2,a.height/2),c=e(a.x,a.width,h.width),d=e(a.y,a.height,h.height);b.m_vertices.forEach(function(a){a.x+=c,a.y+=d}),k(b,a.options)}),d(h.circles,function(a){var b=new b2CircleShape(a.size/2),c=e(a.x,a.size,h.width),d=e(a.y,a.size,h.height);b.SetLocalPosition(new b2Vec2(c,d)),k(b,a.options)}),g.width=h.width,g.height=h.height,g},h.b=h.box,h.c=h.circle,h}function h(){function f(f,g,h){var i,j,k=f.GetPosition();return arguments.length===1&&(g=h=0),g=e(g,0,f.width),h=e(h,0,f.width),g+=k.x,h+=k.y,c.push([f,g,h]),c.length===2&&(i=new b2Vec2(c[0][1],c[0][2]),j=new b2Vec2(c[1][1],c[1][2]),b.joint=d.Initialize(c[0][0],c[1][0],i,j),a.CreateJoint(d)),b}var b={},c=[],d=new b2DistanceJointDef;return b.a=b.b=f,b}function i(a){var b=a.GetPosition();if(typeof a.width=="undefined"||typeof a.height=="undefined")a.width=0,a.height=0;return{x:b.x-a.width/2,y:b.y-a.height/2,origo:{x:b.x,y:b.y},width:a.width,height:a.height}}function j(a){var b={bodyWraps:[]};return b.create=function(){var a=[];return d(b.bodyWraps,function(b){a.push(b.create())}),a},d(a,function(a){var e;a=c(a,{x:0,y:0,isStatic:!1,options:{}}),e=g(a),d(a.boxes,function(a){a=c(a,{x:0,y:0,width:1,height:1,options:{}}),e.box(a)}),d(a.circles,function(a){a=c(a,{x:0,y:0,size:1,options:{}}),e.circle(a)}),b.bodyWraps.push(e)}),b}var a;return{init:f,body:g,b:g,joint:h,position:i,pos:i,build:j}}();